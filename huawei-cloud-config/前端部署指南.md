# æ ¡å›­äºŒæ‰‹ä¹¦äº¤æ˜“ç³»ç»Ÿå‰ç«¯éƒ¨ç½²æŒ‡å—

## éƒ¨ç½²æ­¥éª¤

### ç¬¬1æ­¥: ä¿®æ”¹APIé…ç½®

#### 1.1 ä¿®æ”¹APIä»£ç†é…ç½®
åœ¨æœ¬æœº `æ ¡å›­äºŒæ‰‹ä¹¦/vite.config.js` ä¸­ä¿®æ”¹ï¼š
```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  },
  server: {
    port: 3000,
    proxy: {
      '/book-api': {
        target: 'http://121.36.98.215:8080', // å…¬ç½‘åœ°å€
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/book-api/, '/book-api')
      }
    }
  }
})
```





### ç¬¬2æ­¥: æž„å»ºç”Ÿäº§ç‰ˆæœ¬

åœ¨æœ¬æœºä¸Šæ‰§è¡Œ
```bash
# åœ¨/æ ¡å›­äºŒæ‰‹ä¹¦/ç›®å½•ä¸‹æ‰§è¡Œ
npm install
npm run build
```

æž„å»ºå®ŒæˆåŽï¼Œä¼šåœ¨ `/æ ¡å›­äºŒæ‰‹ä¹¦/dist/` ç›®å½•ä¸‹ç”Ÿæˆç”Ÿäº§æ–‡ä»¶ã€‚

### ç¬¬3æ­¥: éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨

#### 3.1 git cloneé¡¹ç›®åˆ°äº‘æœåŠ¡å™¨
```bash
# åœ¨äº‘æœåŠ¡å™¨/home/book-platformç›®å½•ä¸‹æ‰§è¡Œ
git clone https://gitee.com/aoae0/book.git
```

#### 3.2 å¤åˆ¶æž„å»ºæ–‡ä»¶
```bash
# åœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
mkdir -p /var/www/html/book-platform
cp -r dist/* /var/www/html/book-platform/
```

### ç¬¬4æ­¥: é…ç½®Nginxåå‘ä»£ç†

#### 4.1 å®‰è£…Nginx
```bash
# CentOS/RHEL
yum install -y nginx


#### 4.2 é…ç½®Nginx
åˆ›å»ºé…ç½®æ–‡ä»¶ `/etc/nginx/conf.d/book-platform.conf`ï¼š

```bash
cat > /etc/nginx/conf.d/book-platform.conf << 'EOF'
server {
    listen 80;
    server_name ecså…¬ç½‘ip;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/html/book-platform;
        index index.html;
        try_files $uri $uri/ /index.html;
        
        # å¤„ç†Vue Routerçš„historyæ¨¡å¼
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
    
    # APIä»£ç†åˆ°åŽç«¯æœåŠ¡
    location /book-api/ {
        proxy_pass http://localhost:8080/book-api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # è·¨åŸŸå¤„ç†
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS';
        add_header Access-Control-Allow-Headers 'Content-Type, Authorization, X-Requested-With';
        
        # å¤„ç†OPTIONSè¯·æ±‚
        if ($request_method = 'OPTIONS') {
            add_header Access-Control-Allow-Origin *;
            add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS';
            add_header Access-Control-Allow-Headers 'Content-Type, Authorization, X-Requested-With';
            add_header Access-Control-Max-Age 1728000;
            return 204;
        }
    }
}
EOF
```
###è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
```bash
# è®¾ç½®ç›®å½•æ‰€æœ‰è€…
chown -R nginx:nginx /var/www/html/book-platform

# è®¾ç½®ç›®å½•æƒé™ä¸º 755
find /var/www/html/book-platform -type d -exec chmod 755 {} \;

# è®¾ç½®æ–‡ä»¶æƒé™ä¸º 644
find /var/www/html/book-platform -type f -exec chmod 644 {} \;
```

#### 4.3 å¯åŠ¨Nginx
```bash
# å¯åŠ¨æœåŠ¡
systemctl start nginx
systemctl enable nginx

# é‡è½½é…ç½®
nginx -t && systemctl reload nginx
```

### ç¬¬5æ­¥: é…ç½®é˜²ç«å¢™

#### 5.1 å¼€æ”¾80ç«¯å£
```bash
firewall-cmd --permanent --add-port=80/tcp
firewall-cmd --reload
```

#### 5.2 æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
systemctl status nginx
netstat -tlnp | grep 80
```

## ðŸŒ è®¿é—®æµ‹è¯•